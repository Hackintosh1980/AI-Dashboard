Hier kommt die saubere, druckfertige Beschreibung zu deinem
permission_fix.py â€“ kurz, aber absolut fachlich klar.
Perfekt fÃ¼r deine Doku-Mappe:


---

Kapitel â€“ permission_fix.py

Android-Berechtigungen zuverlÃ¤ssig erzwingen

permission_fix.py ist ein kleines, aber essenzielles Hilfsmodul in deinem Android-Stack.
Es stellt sicher, dass die App alle erforderlichen Systemrechte besitzt, bevor die BLE-Bridge aktiviert wird.

Ohne diese Rechte wÃ¼rde:

kein BLE-Scan laufen

kein RAW-Dump entstehen

das Dashboard sofort â€žtotâ€œ starten

der Watchdog permanent OFFLINE melden


Darum ruft core.py â†’ check_permissions() direkt beim Start auf.


---

Warum dieses Modul existiert

Android verschÃ¤rft seit Version 12/13/14 die Regeln fÃ¼r:

BLUETOOTH_SCAN

BLUETOOTH_CONNECT

Standortrechte beim Scannen

HintergrundausfÃ¼hrung


Wenn nur eine einzige dieser Berechtigungen fehlt, bricht der gesamte BLE-Stack zusammen.

Darum erzwingt dein Modul aktiv:

Permission.BLUETOOTH
Permission.BLUETOOTH_ADMIN
Permission.BLUETOOTH_CONNECT
Permission.BLUETOOTH_SCAN
Permission.ACCESS_FINE_LOCATION
Permission.ACCESS_COARSE_LOCATION

Das ist exakt der Satz, den moderne Android-BLE-APIs verlangen.


---

Wie das Modul arbeitet

1. Plattformtest

if platform != "android":
    return True

â†’ Auf Desktop wird das Modul komplett Ã¼bersprungen.
â†’ Keine Dummy-Abfragen, keine Fehler.

Reines Android-Modul.


---

2. Check + Request

Das Modul nutzt:

check_permission(...)
request_permissions([...])

vom offiziellen android.permissions-Package.

Ablauf:

1. Alle wichtigen BLE/Location-Permissions zusammenstellen


2. PrÃ¼fen, welche fehlen


3. Fehlende sofort vom System anfordern


4. RÃ¼ckmeldung geben (True/False)



Das sorgt dafÃ¼r, dass die App sofort sauber starten kann â€“
oder der User klar erkennt, warum BLE gerade nicht funktioniert.


---

Besondere Eigenschaften

âœ” minimalistisch und stabil
âœ” keine UI-Interaktion nÃ¶tig â€“ Android zeigt den Dialog selbst
âœ” verhindert â€žSilent Failureâ€œ (der schlimmste Fehler bei BLE-Apps)
âœ” arbeitet perfekt mit deiner BleBridgePersistent Java-Bridge zusammen
âœ” nicht gekoppelt an Config, Core oder Decoder â€“ Eigenmodul
âœ” lÃ¤sst sich jederzeit erweitern (z. B. Foreground-Service-Permission spÃ¤ter)


---

Warum es kritisch fÃ¼r die gesamte Plattform ist

Ohne permission_fix.py riskierst du:

kein BLE â†’ kein Dump â†’ kein Decoded â†’ kein Dashboard

Stale/OFFLINE permanent aktiv

Watchdog tickt ins Leere

Decoder schreibt nur OFFLINE-Frames

Dashboard zeigt â€žNO DATAâ€œ

der Nutzer denkt â€žApp kaputtâ€œ


Mit diesem Modul passiert exakt das nicht.

Es ist also die erste SicherheitsprÃ¼fung im gesamten Startprozess.


---

Wenn du willst, kÃ¶nnen wir als NÃ¤chstes:

ðŸ‘‰ â€žcore.pyâ€œ dokumentieren â€“ das HerzstÃ¼ck, das alles zusammenfÃ¼hrt
oder
ðŸ‘‰ â€ždecoder.pyâ€œ â€“ die KÃ¶nigsdisziplin

Sag einfach â€žweiter mit coreâ€œ.